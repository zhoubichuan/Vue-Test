---
lang: zh-CN
sidebarDepth: 2
meta:
  - name: description
    content: 个人总结的openlayers学习技术文档-语法
  - name: keywords
    content: vuepress,最新技术文档,vuepress语法,markdown语法
---

# 五.案例 5

## 1.图层组

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
  <div id="layertree">
    <h5>Click on layer nodes below to change their properties.</h5>
    <ul>
      <li>
        <span>OSM layer</span>
        <fieldset id="layer0">
          <label class="checkbox" for="visible0">
            visible <input id="visible0" class="visible" type="checkbox" />
          </label>
          <label>
            opacity
            <input class="opacity" type="range" min="0" max="1" step="0.01" />
          </label>
        </fieldset>
      </li>
      <li>
        <span>Layer group</span>
        <fieldset id="layer1">
          <label class="checkbox" for="visible1">
            visible <input id="visible1" class="visible" type="checkbox" />
          </label>
          <label>
            opacity
            <input class="opacity" type="range" min="0" max="1" step="0.01" />
          </label>
        </fieldset>
        <ul>
          <li>
            <span>Food insecurity layer</span>
            <fieldset id="layer10">
              <label class="checkbox" for="visible10">
                visible <input id="visible10" class="visible" type="checkbox" />
              </label>
              <label>
                opacity
                <input
                  class="opacity"
                  type="range"
                  min="0"
                  max="1"
                  step="0.01"
                />
              </label>
            </fieldset>
          </li>
          <li>
            <span>World borders layer</span>
            <fieldset id="layer11">
              <label class="checkbox" for="visible11">
                visible <input id="visible11" class="visible" type="checkbox" />
              </label>
              <label>
                opacity
                <input
                  class="opacity"
                  type="range"
                  min="0"
                  max="1"
                  step="0.01"
                />
              </label>
            </fieldset>
          </li>
        </ul>
      </li>
    </ul>
  </div>
</template>

<script>
export default {
  mounted() {
    let {
      Map,
      View,
      layer: { Tile: TileLayer, Group: LayerGroup },
      source: { OSM, TileJSON },
      proj: { fromLonLat },
    } = ol

    const map = new Map({
      layers: [
        new TileLayer({
          source: new OSM(),
        }),
        new LayerGroup({
          layers: [
            new TileLayer({
              source: new TileJSON({
                url:
                  "https://api.tiles.mapbox.com/v4/mapbox.20110804-hoa-foodinsecurity-3month.json?secure&access_token=" +
                  mapkeys.mapbox,
                crossOrigin: "anonymous",
              }),
            }),
            new TileLayer({
              source: new TileJSON({
                url:
                  "https://api.tiles.mapbox.com/v4/mapbox.world-borders-light.json?secure&access_token=" +
                  mapkeys.mapbox,
                crossOrigin: "anonymous",
              }),
            }),
          ],
        }),
      ],
      target: this.$refs.map,
      view: new View({
        center: fromLonLat([37.4057, 8.81566]),
        zoom: 4,
      }),
    })

    function bindInputs(layerid, layer) {
      const visibilityInput = $(layerid + " input.visible")
      visibilityInput.on("change", function () {
        layer.setVisible(this.checked)
      })
      visibilityInput.prop("checked", layer.getVisible())

      const opacityInput = $(layerid + " input.opacity")
      opacityInput.on("input change", function () {
        layer.setOpacity(parseFloat(this.value))
      })
      opacityInput.val(String(layer.getOpacity()))
    }
    function setup(id, group) {
      group.getLayers().forEach(function (layer, i) {
        const layerid = id + i
        bindInputs(layerid, layer)
        if (layer instanceof LayerGroup) {
          setup(layerid, layer)
        }
      })
    }
    setup("#layer", map.getLayerGroup())

    $("#layertree li > span")
      .click(function () {
        $(this).siblings("fieldset").toggle()
      })
      .siblings("fieldset")
      .hide()
  },
}
</script>
```

:::

## 2.图层最小/最大分辨率

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      Map,
      View,
      layer: { Tile: TileLayer },
      source: { OSM, TileJSON },
    } = ol
    const map = new Map({
      layers: [
        new TileLayer({
          source: new OSM(),
          minResolution: 200,
          maxResolution: 2000,
        }),
        new TileLayer({
          source: new TileJSON({
            url:
              "https://api.tiles.mapbox.com/v4/mapbox.natural-earth-hypso-bathy.json?secure&access_token=" +
              mapkeys.mapbox,
            crossOrigin: "anonymous",
          }),
          minResolution: 2000,
          maxResolution: 20000,
        }),
      ],
      target: this.$refs.map,
      view: new View({
        center: [653600, 5723680],
        zoom: 5,
      }),
    })
  },
}
</script>
```

:::

## 3.层不透明度

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
  <label>
    Layer opacity
    <input
      id="opacity-input"
      type="range"
      min="0"
      max="1"
      step="0.01"
      value="1"
    />
    <span id="opacity-output"></span>
  </label>
</template>

<script>
export default {
  mounted() {
    let {
      Map,
      View,
      layer: { WebGLTile: TileLayer },
      source: { XYZ, OSM },
      style: Style,
      proj: { fromLonLat },
    } = ol

    const imagery = new TileLayer({
      className: "ol-layer-imagery",
      source: new XYZ({
        attributions:
          '<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> ',
        url:
          "https://api.maptiler.com/tiles/satellite/{z}/{x}/{y}.jpg?key=" +
          mapkeys.maptiler,
        maxZoom: 20,
        crossOrigin: "",
      }),
    })

    const osm = new TileLayer({
      source: new OSM(),
    })

    const map = new Map({
      layers: [imagery, osm],
      target: this.$refs.map,
      view: new View({
        center: [12579156, 3274244],
        zoom: 2,
      }),
    })

    const opacityInput = document.getElementById("opacity-input")
    const opacityOutput = document.getElementById("opacity-output")
    function update() {
      const opacity = parseFloat(opacityInput.value)
      osm.setOpacity(opacity)
      opacityOutput.innerText = opacity.toFixed(2)
    }
    opacityInput.addEventListener("input", update)
    opacityInput.addEventListener("change", update)
    update()
  },
}
</script>
```

:::

