---
lang: zh-CN
sidebarDepth: 2
meta:
  - name: description
    content: 个人总结的openlayers学习技术文档-语法
  - name: keywords
    content: vuepress,最新技术文档,vuepress语法,markdown语法
---

# 十九.案例 19

## 2.平滑绘制的线条

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
  <form class="form-inline">
    <label for="shall-smoothen">Smooth drawn geometry?</label>
    <input id="shall-smoothen" type="checkbox" checked /><br />
    <label for="iterations">Number of smoothings</label>
    <input
      style="width: 250px;"
      type="range"
      id="iterations"
      min="2"
      max="10"
      step="1"
      value="5"
    />
  </form>
</template>

<script>
export default {
  mounted() {
    let {
      interaction: { Draw },
      Map,
      View,
      layer: { Tile: TileLayer, Vector: VectorLayer },
      source: { OSM, Vector: VectorSource },
      style: Style,
      proj: { fromLonLat },
    } = ol
    function makeSmooth(path, numIterations) {
      numIterations = Math.min(Math.max(numIterations, 1), 10)
      while (numIterations > 0) {
        path = smooth(path)
        numIterations--
      }
      return path
    }
    const vectorSource = new VectorSource({})
    const map = new Map({
      layers: [
        new TileLayer({
          source: new OSM(),
          opacity: 0.5,
        }),
        new VectorLayer({
          source: vectorSource,
        }),
      ],
      target: this.$refs.map,
      view: new View({
        center: [1078373.595, 6871994.591],
        zoom: 5,
      }),
    })
    const shallSmoothen = document.getElementById("shall-smoothen")
    const numIterations = document.getElementById("iterations")
    const draw = new Draw({
      source: vectorSource,
      type: "LineString",
    })
    map.addInteraction(draw)
    draw.on("drawend", function (event) {
      if (!shallSmoothen.checked) {
        return
      }
      const feat = event.feature
      const geometry = feat.getGeometry()
      const coords = geometry.getCoordinates()
      const smoothened = makeSmooth(
        coords,
        parseInt(numIterations.value, 10) || 5
      )
      geometry.setCoordinates(smoothened)
    })
  },
}
</script>
```

:::

## 4.球体

带有经纬网图层的 Sphere Mollweide 地图

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      format: { GeoJSON },
      Map,
      View,
      layer: { Graticule, Vector: VectorLayer },
      source: { OSM, Vector: VectorSource },
      style: { Fill, Style },
      proj: {
        Projection,
        proj4: { register },
      },
    } = ol
    // import proj4 from 'proj4';
    proj4.defs(
      "ESRI:53009",
      "+proj=moll +lon_0=0 +x_0=0 +y_0=0 +a=6371000 " +
        "+b=6371000 +units=m +no_defs"
    )
    register(proj4)
    const sphereMollweideProjection = new Projection({
      code: "ESRI:53009",
      extent: [
        -18019909.21177587, -9009954.605703328, 18019909.21177587,
        9009954.605703328,
      ],
      worldExtent: [-179, -89.99, 179, 89.99],
    })

    const style = new Style({
      fill: new Fill({
        color: "#eeeeee",
      }),
    })

    const map = new Map({
      keyboardEventTarget: document,
      layers: [
        new VectorLayer({
          source: new VectorSource({
            url: "https://openlayers.org/data/vector/ecoregions.json",
            format: new GeoJSON(),
          }),
          style: function (feature) {
            const color = feature.get("COLOR_BIO") || "#eeeeee"
            style.getFill().setColor(color)
            return style
          },
        }),
        new Graticule(),
      ],
      target: this.$refs.map,
      view: new View({
        center: [12579156, 3274244],
        projection: sphereMollweideProjection,
        zoom: 2,
      }),
    })
  },
}
</script>
```

:::
