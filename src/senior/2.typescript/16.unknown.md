---
lang: zh-CN
sidebarDepth: 2
meta:
  - name: description
    content: 个人总结的openlayers学习技术文档-语法
  - name: keywords
    content: vuepress,最新技术文档,vuepress语法,markdown语法
---

# 十六.案例 16

## 1.可重复使用的来源

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
  <button class="switcher" value="0">January</button>
  <button class="switcher" value="1">January (with bathymetry)</button>
  <button class="switcher" value="2">July</button>
  <button class="switcher" value="3">July (with bathymetry)</button>
</template>

<script>
export default {
  mounted() {
    let {
      Map,
      View,
      layer: { Tile: TileLayer },
      source: { XYZ },
    } = ol

    const baseUrl = "https://{a-c}.tiles.mapbox.com/v4"
    const urls = [
      baseUrl +
        "/mapbox.blue-marble-topo-jan/{z}/{x}/{y}.png?access_token=" +
        mapkeys.mapbox,
      baseUrl +
        "/mapbox.blue-marble-topo-bathy-jan/{z}/{x}/{y}.png?access_token=" +
        mapkeys.mapbox,
      baseUrl +
        "/mapbox.blue-marble-topo-jul/{z}/{x}/{y}.png?access_token=" +
        mapkeys.mapbox,
      baseUrl +
        "/mapbox.blue-marble-topo-bathy-jul/{z}/{x}/{y}.png?access_token=" +
        mapkeys.mapbox,
    ]

    const source = new XYZ()

    const map = new Map({
      target: this.$refs.map,
      layers: [
        new TileLayer({
          source: source,
        }),
      ],
      view: new View({
        center: [12579156, 3274244],
        zoom: 2,
      }),
    })

    function updateUrl(index) {
      source.setUrl(urls[index])
    }

    const buttons = document.getElementsByClassName("switcher")
    for (let i = 0, ii = buttons.length; i < ii; ++i) {
      const button = buttons[i]
      button.addEventListener(
        "click",
        updateUrl.bind(null, Number(button.value))
      )
    }

    updateUrl(0)
  },
}
</script>
```

:::

## 2.富文本标签

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      format: { GeoJSON },
      Map,
      View,
      layer: { Vector: VectorLayer },
      source: { Vector: VectorSource },
      style: { Fill, Stroke, Style, Text },
    } = ol

    const map = new Map({
      target: this.$refs.map,
      view: new View({
        center: [12579156, 3274244],
        zoom: 2,
        extent: [-13882269, 2890586, -7456136, 6340207],
        showFullExtent: true,
      }),
    })

    const labelStyle = new Style({
      text: new Text({
        font: "13px Calibri,sans-serif",
        fill: new Fill({
          color: "#000",
        }),
        stroke: new Stroke({
          color: "#fff",
          width: 4,
        }),
      }),
    })
    const countryStyle = new Style({
      fill: new Fill({
        color: "rgba(255, 255, 255, 0.6)",
      }),
      stroke: new Stroke({
        color: "#319FD3",
        width: 1,
      }),
    })
    const style = [countryStyle, labelStyle]

    const vectorLayer = new VectorLayer({
      background: "white",
      source: new VectorSource({
        url: "https://openlayers.org/data/vector/us-states.json",
        format: new GeoJSON(),
      }),
      style: function (feature) {
        labelStyle
          .getText()
          .setText([
            feature.getId(),
            "bold 13px Calibri,sans-serif",
            ` ${feature.get("name")}`,
            "",
            "\n",
            "",
            `${feature.get("density")} people/mi²`,
            "italic 11px Calibri,sans-serif",
          ])
        return style
      },
    })

    map.addLayer(vectorLayer)
  },
}
</script>
```

:::

## 4.比例线

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
  <select id="units">
    <option value="degrees">度</option>
    <option value="imperial">英制英寸</option>
    <option value="us">美国英寸</option>
    <option value="nautical">海里</option>
    <option value="metric" selected>米</option>
  </select>

  <select id="type">
    <option value="scaleline">标线</option>
    <option value="scalebar">比例尺</option>
  </select>

  <select id="steps" style="display:none">
    <option value="2">2 steps</option>
    <option value="4" selected>4 steps</option>
    <option value="6">6 steps</option>
    <option value="8">8 steps</option>
  </select>

  <div id="showScaleTextDiv" style="display:none">
    <label
      ><input type="checkbox" id="showScaleText" checked /> 显示缩放文本</label
    >
  </div>
</template>

<script>
export default {
  mounted() {
    let {
      control: { ScaleLine, defaults: defaultControls },
      Map,
      View,
      layer: { Tile: TileLayer },
      source: { OSM },
    } = ol

    const unitsSelect = document.getElementById("units")
    const typeSelect = document.getElementById("type")
    const stepsSelect = document.getElementById("steps")
    const scaleTextCheckbox = document.getElementById("showScaleText")
    const showScaleTextDiv = document.getElementById("showScaleTextDiv")

    let scaleType = "scaleline"
    let scaleBarSteps = 4
    let scaleBarText = true
    let control

    function scaleControl() {
      if (scaleType === "scaleline") {
        control = new ScaleLine({
          units: unitsSelect.value,
        })
        return control
      }
      control = new ScaleLine({
        units: unitsSelect.value,
        bar: true,
        steps: scaleBarSteps,
        text: scaleBarText,
        minWidth: 140,
      })
      return control
    }
    const map = new Map({
      controls: defaultControls().extend([scaleControl()]),
      layers: [
        new TileLayer({
          source: new OSM(),
        }),
      ],
      target: this.$refs.map,
      view: new View({
        center: [12579156, 3274244],
        zoom: 2,
      }),
    })

    function onChange() {
      control.setUnits(unitsSelect.value)
    }
    function onChangeType() {
      scaleType = typeSelect.value
      if (typeSelect.value === "scalebar") {
        stepsSelect.style.display = "inline"
        showScaleTextDiv.style.display = "inline"
        map.removeControl(control)
        map.addControl(scaleControl())
      } else {
        stepsSelect.style.display = "none"
        showScaleTextDiv.style.display = "none"
        map.removeControl(control)
        map.addControl(scaleControl())
      }
    }
    function onChangeSteps() {
      scaleBarSteps = parseInt(stepsSelect.value, 10)
      map.removeControl(control)
      map.addControl(scaleControl())
    }
    function onChangeScaleText() {
      scaleBarText = scaleTextCheckbox.checked
      map.removeControl(control)
      map.addControl(scaleControl())
    }
    unitsSelect.addEventListener("change", onChange)
    typeSelect.addEventListener("change", onChangeType)
    stepsSelect.addEventListener("change", onChangeSteps)
    scaleTextCheckbox.addEventListener("change", onChangeScaleText)
  },
}
</script>
```

:::

