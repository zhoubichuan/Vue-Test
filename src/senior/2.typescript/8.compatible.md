---
lang: zh-CN
sidebarDepth: 2
meta:
  - name: description
    content: 个人总结的openlayers学习技术文档-语法
  - name: keywords
    content: vuepress,最新技术文档,vuepress语法,markdown语法
---

# 八.案例8

## 1.地图 Graticule

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      Map,
      View,
      layer: { Tile: TileLayer, Graticule },
      source: { OSM },
      style: { Stroke },
      proj: { fromLonLat },
    } = ol

    const map = new Map({
      layers: [
        new TileLayer({
          source: new OSM({
            wrapX: false,
          }),
        }),
        new Graticule({
          // the style to use for the lines, optional.
          strokeStyle: new Stroke({
            color: "rgba(255,120,0,0.9)",
            width: 2,
            lineDash: [0.5, 4],
          }),
          showLabels: true,
          wrapX: false,
        }),
      ],
      target: this.$refs.map,
      view: new View({
        center: fromLonLat([4.8, 47.75]),
        zoom: 5,
      }),
    })
  },
}
</script>
```

:::

## 2.Mapbox 矢量图层

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      Map,
      View,
      layer: { MapboxVector },
    } = ol
    const map = new Map({
      target: this.$refs.map,
      layers: [
        new MapboxVector({
          styleUrl: "mapbox://styles/mapbox/bright-v9",
          accessToken: "pk.eyJ1IjoiemhvdWJpY2h1YW4iLCJhIjoiY2wyZGRleThpMHk5YjNkcDkzMWNveXB0YSJ9.L0LaQDinn6bNDLgQQmcuxQ",
        }),
      ],
      view: new View({
        center: [0, 0],
        zoom: 2,
      }),
    })
  },
}
</script>
```

:::

## 3.Mapbox 矢量瓷砖

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      format: { MVT },
      Map,
      View,
      layer: { VectorTile: VectorTileLayer },
      source: { VectorTile: VectorTileSource },
      style: { Fill, Icon, Stroke, Style, Text },
    } = ol

    const key = "pk.eyJ1IjoiemhvdWJpY2h1YW4iLCJhIjoiY2wyZGRleThpMHk5YjNkcDkzMWNveXB0YSJ9.L0LaQDinn6bNDLgQQmcuxQ"

    const map = new Map({
      layers: [
        new VectorTileLayer({
          declutter: true,
          source: new VectorTileSource({
            attributions:
              '© <a href="https://www.mapbox.com/map-feedback/">Mapbox</a> ' +
              '© <a href="https://www.openstreetmap.org/copyright">' +
              "OpenStreetMap contributors</a>",
            format: new MVT(),
            url:
              "https://{a-d}.tiles.mapbox.com/v4/mapbox.mapbox-streets-v6/" +
              "{z}/{x}/{y}.vector.pbf?access_token=" +
              key,
          }),
          style: createMapboxStreetsV6Style(Style, Fill, Stroke, Icon, Text),
        }),
      ],
      target: this.$refs.map,
      view: new View({
        center: [0, 0],
        zoom: 2,
      }),
    })
  },
}
</script>
```

:::

## 4.Mapbox-gl 层

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      format: { GeoJSON },
      Map,
      View,
      layer: { Heatmap: HeatmapLayer, Layer },
      source: { Source, Vector: VectorSource },
      proj: { fromLonLat, toLonLat },
    } = ol

    const center = [-98.8, 37.9]
    const key = "Get your own API key at https://www.maptiler.com/cloud/"

    const mbMap = new mapboxgl.Map({
      style: "https://api.maptiler.com/maps/bright/style.json?key=" + key,
      attributionControl: false,
      boxZoom: false,
      center: center,
      container: "map",
      doubleClickZoom: false,
      dragPan: false,
      dragRotate: false,
      interactive: false,
      keyboard: false,
      pitchWithRotate: false,
      scrollZoom: false,
      touchZoomRotate: false,
    })

    const mbLayer = new Layer({
      render: function (frameState) {
        const canvas = mbMap.getCanvas()
        const viewState = frameState.viewState

        const visible = mbLayer.getVisible()
        canvas.style.display = visible ? "block" : "none"
        canvas.style.position = "absolute"

        const opacity = mbLayer.getOpacity()
        canvas.style.opacity = opacity

        // adjust view parameters in mapbox
        const rotation = viewState.rotation
        mbMap.jumpTo({
          center: toLonLat(viewState.center),
          zoom: viewState.zoom - 1,
          bearing: (-rotation * 180) / Math.PI,
          animate: false,
        })

        // cancel the scheduled update & trigger synchronous redraw
        // see https://github.com/mapbox/mapbox-gl-js/issues/7893#issue-408992184
        // NOTE: THIS MIGHT BREAK IF UPDATING THE MAPBOX VERSION
        if (mbMap._frame) {
          mbMap._frame.cancel()
          mbMap._frame = null
        }
        mbMap._render()

        return canvas
      },
      source: new Source({
        attributions: [
          '<a href="https://www.maptiler.com/copyright/" target="_blank">© MapTiler</a>',
          '<a href="https://www.openstreetmap.org/copyright" target="_blank">© OpenStreetMap contributors</a>',
        ],
      }),
    })

    const cities = new HeatmapLayer({
      source: new VectorSource({
        url: "data/geojson/world-cities.geojson",
        format: new GeoJSON(),
      }),
      weight: function (feature) {
        return feature.get("population") / 1e7
      },
      radius: 15,
      blur: 15,
    })

    const map = new Map({
      target: this.$refs.map,
      view: new View({
        center: fromLonLat(center),
        zoom: 4,
      }),
      layers: [mbLayer, cities],
    })
  },
}
</script>
```

:::

## 5.MapGuide 留用

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      Map,
      View,
      layer: { Image: ImageLayer },
      source: { ImageMapGuide },
    } = ol

    const mdf = "Library://Samples/Sheboygan/Maps/Sheboygan.MapDefinition"
    const agentUrl = "https://mikenunn.net/mapguide/mapagent/mapagent.fcgi?"
    const bounds = [
      -87.865114442365922, 43.665065564837931, -87.595394059497067,
      43.823852564430069,
    ]
    const map = new Map({
      layers: [
        new ImageLayer({
          extent: bounds,
          source: new ImageMapGuide({
            projection: "EPSG:4326",
            url: agentUrl,
            useOverlay: false,
            metersPerUnit: 111319.4908, //value returned from mapguide
            params: {
              MAPDEFINITION: mdf,
              FORMAT: "PNG",
              VERSION: "3.0.0",
              USERNAME: "OLGuest",
              PASSWORD: "olguest",
            },
            ratio: 2,
          }),
        }),
      ],
      target: this.$refs.map,
      view: new View({
        center: [-87.7302542509315, 43.744459064634],
        projection: "EPSG:4326",
        zoom: 12,
      }),
    })
  },
}
</script>
```

:::
