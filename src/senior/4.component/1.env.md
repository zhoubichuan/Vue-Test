---
lang: zh-CN
sidebarDepth: 2
meta:
  - name: description
    content: 个人总结的openlayers学习技术文档-语法
  - name: keywords
    content: vuepress,最新技术文档,vuepress语法,markdown语法
---

# 一.案例 1

## 3.传送地图

:::demo

```vue
<template>
  <div id="map1" class="map"></div>
  <div id="map2" class="map"></div>
  <button id="teleport">Teleport</button>
</template>

<script>
export default {
  mounted() {
    let {
      Map,
      View,
      layer: { Tile: TileLayer },
      source: { OSM },
    } = ol
    const map = new Map({
      layers: [
        new TileLayer({
          source: new OSM(),
        }),
      ],
      view: new View({
        center: [12579156, 3274244],
        zoom: 2,
      }),
    })

    map.setTarget("map1")

    const teleportButton = document.getElementById("teleport")

    teleportButton.addEventListener(
      "click",
      function () {
        const target = map.getTarget() === "map1" ? "map2" : "map1"
        map.setTarget(target)
      },
      false
    )
  },
}
</script>
```

:::

## 4.瓦片加载事件

:::demo

```vue
<template>
  <div class="wrapper">
    <div ref="map" class="map"></div>
    <div id="progress"></div>
  </div>
</template>

<script>
export default {
  mounted() {
    let {
      Map,
      View,
      layer: { Tile: TileLayer },
      source: { XYZ },
    } = ol
    function Progress(el) {
      this.el = el
      this.loading = 0
      this.loaded = 0
    }

    /**
     * Increment the count of loading tiles.
     */
    Progress.prototype.addLoading = function () {
      ++this.loading
      this.update()
    }

    /**
     * Increment the count of loaded tiles.
     */
    Progress.prototype.addLoaded = function () {
      ++this.loaded
      this.update()
    }

    /**
     * Update the progress bar.
     */
    Progress.prototype.update = function () {
      const width = ((this.loaded / this.loading) * 100).toFixed(1) + "%"
      this.el.style.width = width
    }

    /**
     * Show the progress bar.
     */
    Progress.prototype.show = function () {
      this.el.style.visibility = "visible"
    }

    /**
     * Hide the progress bar.
     */
    Progress.prototype.hide = function () {
      const style = this.el.style
      setTimeout(function () {
        style.visibility = "hidden"
        style.width = 0
      }, 250)
    }

    const progress = new Progress(document.getElementById("progress"))

    const key = "get_your_own_D6rA4zTHduk6KOKTXzGB"
    const attributions =
      '<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> ' +
      '<a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>'

    const source = new XYZ({
      attributions: attributions,
      url: "https://api.maptiler.com/maps/streets/{z}/{x}/{y}.png?key=" + key,
      tileSize: 512,
    })

    source.on("tileloadstart", function () {
      progress.addLoading()
    })
    source.on(["tileloadend", "tileloaderror"], function () {
      progress.addLoaded()
    })

    const map = new Map({
      layers: [new TileLayer({ source: source })],
      target: this.$refs.map,
      view: new View({
        center: [12579156, 3274244],
        zoom: 2,
      }),
    })

    map.on("loadstart", function () {
      progress.show()
    })
    map.on("loadend", function () {
      progress.hide()
    })
  },
}
</script>
```

:::

## 5.瓦片过渡

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
  <label>
    render with an opacity transition
    <input id="transition" type="checkbox" checked />
  </label>
</template>

<script>
export default {
  mounted() {
    let {
      Map,
      View,
      layer: { Tile: TileLayer },
      source: { XYZ },
    } = ol
    const attributions =
      '<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> ' +
      '<a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>'

    const url =
      "https://api.maptiler.com/maps/streets/{z}/{x}/{y}.png?key=" +
      mapkeys.maptiler

    const withTransition = new TileLayer({
      source: new XYZ({ url: url, tileSize: 512, attributions: attributions }),
    })

    const withoutTransition = new TileLayer({
      source: new XYZ({
        url: url,
        transition: 0,
        tileSize: 512,
        attributions: attributions,
      }),
      visible: false,
    })

    const map = new Map({
      layers: [withTransition, withoutTransition],
      target: this.$refs.map,
      view: new View({
        center: [12579156, 3274244],
        zoom: 2,
        maxZoom: 11,
      }),
    })

    document
      .getElementById("transition")
      .addEventListener("change", function (event) {
        const transition = event.target.checked
        withTransition.setVisible(transition)
        withoutTransition.setVisible(!transition)
      })
  },
}
</script>
```

:::
