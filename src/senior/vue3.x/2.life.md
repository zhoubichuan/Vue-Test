---
lang: zh-CN
sidebarDepth: 2
meta:
  - name: description
    content: 个人总结的openlayers学习技术文档-语法
  - name: keywords
    content: vuepress,最新技术文档,vuepress语法,markdown语法
---

# 二.中国地图

## ChinaOnlineCommunity_Mobile

::: demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  async mounted() {
    let {
      Map,
      View,
      Feature,
      style: { Style, Stroke, Fill },
      layer: { Vector: VectorLayer, Tile: TileLayer },
      geom: { Polygon, MultiPolygon },
      source: { XYZ, Vector: VectorSource },
      proj: { fromLonLat },
      control: { OverviewMap, defaults },
    } = ol;
    let { data } = await this.$axios.get(
      this.$withBase("/data/100000_full.json")
    );
    let map = new Map({
      target: this.$refs.map,
      controls: defaults({
        zoom: true,
      }).extend([]),
      layers: [
        new TileLayer(
          {
            source: new XYZ({
              url: "http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineCommunity_Mobile/MapServer/tile/{z}/{y}/{x}",
            }),
          },
          { zoomOffset: 1 }
        ),
      ],
      view: new View({
        center: fromLonLat([108.522097, 37.272848]),
        zoom: 4.7,
        maxZoom: 19,
        minZoom: 4,
      }),
    });
    let areaLayer = new VectorLayer({
      source: new VectorSource({
        features: [],
      }),
    });
    map.addLayer(areaLayer);

    let areaFeature = null;
    data.features.forEach((g) => {
      let lineData = g;
      if (lineData.geometry.type == "MultiPolygon") {
        areaFeature = new Feature({
          geometry: new MultiPolygon(lineData.geometry.coordinates).transform(
            "EPSG:4326",
            "EPSG:3857"
          ),
        });
      } else if (lineData.geometry.type == "Polygon") {
        areaFeature = new Feature({
          geometry: new Polygon(lineData.geometry.coordinates).transform(
            "EPSG:4326",
            "EPSG:3857"
          ),
        });
      }
    });
    areaFeature.setStyle(
      new Style({
        fill: new Fill({ color: "#4e98f444" }),
        stroke: new Stroke({
          width: 3,
          color: [71, 137, 227, 1],
        }),
      })
    );
    areaLayer.getSource().addFeatures([areaFeature]);
  },
};
</script>
```

:::

## ChinaOnlineCommunityENG

::: demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  async mounted() {
    let {
      Map,
      View,
      Feature,
      style: { Style, Stroke, Fill },
      layer: { Vector: VectorLayer, Tile: TileLayer },
      geom: { Polygon, MultiPolygon },
      source: { XYZ, Vector: VectorSource },
      proj: { fromLonLat },
      control: { OverviewMap, defaults },
    } = ol;
    let { data } = await this.$axios.get(
      this.$withBase("/data/100000_full.json")
    );
    let map = new Map({
      target: this.$refs.map,
      controls: defaults({
        zoom: true,
      }).extend([]),
      layers: [
        new TileLayer(
          {
            source: new XYZ({
              url: "http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineCommunityENG/MapServer/tile/{z}/{y}/{x}",
            }),
          },
          { zoomOffset: 1 }
        ),
      ],
      view: new View({
        center: fromLonLat([108.522097, 37.272848]),
        zoom: 4.7,
        maxZoom: 19,
        minZoom: 4,
      }),
    });
    let areaLayer = new VectorLayer({
      source: new VectorSource({
        features: [],
      }),
    });
    map.addLayer(areaLayer);

    let areaFeature = null;
    data.features.forEach((g) => {
      let lineData = g;
      if (lineData.geometry.type == "MultiPolygon") {
        areaFeature = new Feature({
          geometry: new MultiPolygon(lineData.geometry.coordinates).transform(
            "EPSG:4326",
            "EPSG:3857"
          ),
        });
      } else if (lineData.geometry.type == "Polygon") {
        areaFeature = new Feature({
          geometry: new Polygon(lineData.geometry.coordinates).transform(
            "EPSG:4326",
            "EPSG:3857"
          ),
        });
      }
    });
    areaFeature.setStyle(
      new Style({
        fill: new Fill({ color: "#4e98f444" }),
        stroke: new Stroke({
          width: 3,
          color: [71, 137, 227, 1],
        }),
      })
    );
    areaLayer.getSource().addFeatures([areaFeature]);
  },
};
</script>
```

:::

## ChinaOnlineCommunity

::: demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  async mounted() {
    let {
      Map,
      View,
      Feature,
      style: { Style, Stroke, Fill },
      layer: { Vector: VectorLayer, Tile: TileLayer },
      geom: { Polygon, MultiPolygon },
      source: { XYZ, Vector: VectorSource },
      proj: { fromLonLat },
      control: { OverviewMap, defaults },
    } = ol;
    let { data } = await this.$axios.get(
      this.$withBase("/data/100000_full.json")
    );
    let map = new Map({
      target: this.$refs.map,
      controls: defaults({
        zoom: true,
      }).extend([]),
      layers: [
        new TileLayer(
          {
            source: new XYZ({
              url: "http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineCommunity/MapServer/tile/{z}/{y}/{x}",
            }),
          },
          { zoomOffset: 1 }
        ),
      ],
      view: new View({
        center: fromLonLat([108.522097, 37.272848]),
        zoom: 4.7,
        maxZoom: 19,
        minZoom: 4,
      }),
    });
    let areaLayer = new VectorLayer({
      source: new VectorSource({
        features: [],
      }),
    });
    map.addLayer(areaLayer);

    let areaFeature = null;
    data.features.forEach((g) => {
      let lineData = g;
      if (lineData.geometry.type == "MultiPolygon") {
        areaFeature = new Feature({
          geometry: new MultiPolygon(lineData.geometry.coordinates).transform(
            "EPSG:4326",
            "EPSG:3857"
          ),
        });
      } else if (lineData.geometry.type == "Polygon") {
        areaFeature = new Feature({
          geometry: new Polygon(lineData.geometry.coordinates).transform(
            "EPSG:4326",
            "EPSG:3857"
          ),
        });
      }
    });
    areaFeature.setStyle(
      new Style({
        fill: new Fill({ color: "#4e98f444" }),
        stroke: new Stroke({
          width: 3,
          color: [71, 137, 227, 1],
        }),
      })
    );
    areaLayer.getSource().addFeatures([areaFeature]);
  },
};
</script>
```

:::

## ChinaOnlineStreetGray

::: demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  async mounted() {
    let {
      Map,
      View,
      Feature,
      style: { Style, Stroke, Fill },
      layer: { Vector: VectorLayer, Tile: TileLayer },
      geom: { Polygon, MultiPolygon },
      source: { XYZ, Vector: VectorSource },
      proj: { fromLonLat },
      control: { OverviewMap, defaults },
    } = ol;
    let { data } = await this.$axios.get(
      this.$withBase("/data/100000_full.json")
    );
    let map = new Map({
      target: this.$refs.map,
      controls: defaults({
        zoom: true,
      }).extend([]),
      layers: [
        new TileLayer(
          {
            source: new XYZ({
              url: "http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetGray/MapServer/tile/{z}/{y}/{x}",
            }),
          },
          { zoomOffset: 1 }
        ),
      ],
      view: new View({
        center: fromLonLat([108.522097, 37.272848]),
        zoom: 4.7,
        maxZoom: 19,
        minZoom: 4,
      }),
    });
    let areaLayer = new VectorLayer({
      source: new VectorSource({
        features: [],
      }),
    });
    map.addLayer(areaLayer);

    let areaFeature = null;
    data.features.forEach((g) => {
      let lineData = g;
      if (lineData.geometry.type == "MultiPolygon") {
        areaFeature = new Feature({
          geometry: new MultiPolygon(lineData.geometry.coordinates).transform(
            "EPSG:4326",
            "EPSG:3857"
          ),
        });
      } else if (lineData.geometry.type == "Polygon") {
        areaFeature = new Feature({
          geometry: new Polygon(lineData.geometry.coordinates).transform(
            "EPSG:4326",
            "EPSG:3857"
          ),
        });
      }
    });
    areaFeature.setStyle(
      new Style({
        fill: new Fill({ color: "#4e98f444" }),
        stroke: new Stroke({
          width: 3,
          color: [71, 137, 227, 1],
        }),
      })
    );
    areaLayer.getSource().addFeatures([areaFeature]);
  },
};
</script>
```

:::

## ChinaOnlineStreetPurplishBlue

::: demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  async mounted() {
    let {
      Map,
      View,
      Feature,
      style: { Style, Stroke, Fill },
      layer: { Vector: VectorLayer, Tile: TileLayer },
      geom: { Polygon, MultiPolygon },
      source: { XYZ, Vector: VectorSource },
      proj: { fromLonLat },
      control: { OverviewMap, defaults },
    } = ol;
    let { data } = await this.$axios.get(
      this.$withBase("/data/100000_full.json")
    );
    let map = new Map({
      target: this.$refs.map,
      controls: defaults({
        zoom: true,
      }).extend([]),
      layers: [
        new TileLayer(
          {
            source: new XYZ({
              url: "http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/{z}/{y}/{x}",
            }),
          },
          { zoomOffset: 1 }
        ),
      ],
      view: new View({
        center: fromLonLat([108.522097, 37.272848]),
        zoom: 4.7,
        maxZoom: 19,
        minZoom: 4,
      }),
    });
    let areaLayer = new VectorLayer({
      source: new VectorSource({
        features: [],
      }),
    });
    map.addLayer(areaLayer);

    let areaFeature = null;
    data.features.forEach((g) => {
      let lineData = g;
      if (lineData.geometry.type == "MultiPolygon") {
        areaFeature = new Feature({
          geometry: new MultiPolygon(lineData.geometry.coordinates).transform(
            "EPSG:4326",
            "EPSG:3857"
          ),
        });
      } else if (lineData.geometry.type == "Polygon") {
        areaFeature = new Feature({
          geometry: new Polygon(lineData.geometry.coordinates).transform(
            "EPSG:4326",
            "EPSG:3857"
          ),
        });
      }
    });
    areaFeature.setStyle(
      new Style({
        fill: new Fill({ color: "#4e98f444" }),
        stroke: new Stroke({
          width: 3,
          color: [71, 137, 227, 1],
        }),
      })
    );
    areaLayer.getSource().addFeatures([areaFeature]);
  },
};
</script>
```

:::

## ChinaOnlineStreetWarm

::: demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  async mounted() {
    let {
      Map,
      View,
      Feature,
      style: { Style, Stroke, Fill },
      layer: { Vector: VectorLayer, Tile: TileLayer },
      geom: { Polygon, MultiPolygon },
      source: { XYZ, Vector: VectorSource },
      proj: { fromLonLat },
      control: { OverviewMap, defaults },
    } = ol;
    let { data } = await this.$axios.get(
      this.$withBase("/data/100000_full.json")
    );
    let map = new Map({
      target: this.$refs.map,
      controls: defaults({
        zoom: true,
      }).extend([]),
      layers: [
        new TileLayer(
          {
            source: new XYZ({
              url: "http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetWarm/MapServer/tile/{z}/{y}/{x}",
            }),
          },
          { zoomOffset: 1 }
        ),
      ],
      view: new View({
        center: fromLonLat([108.522097, 37.272848]),
        zoom: 4.7,
        maxZoom: 19,
        minZoom: 4,
      }),
    });
    let areaLayer = new VectorLayer({
      source: new VectorSource({
        features: [],
      }),
    });
    map.addLayer(areaLayer);

    let areaFeature = null;
    data.features.forEach((g) => {
      let lineData = g;
      if (lineData.geometry.type == "MultiPolygon") {
        areaFeature = new Feature({
          geometry: new MultiPolygon(lineData.geometry.coordinates).transform(
            "EPSG:4326",
            "EPSG:3857"
          ),
        });
      } else if (lineData.geometry.type == "Polygon") {
        areaFeature = new Feature({
          geometry: new Polygon(lineData.geometry.coordinates).transform(
            "EPSG:4326",
            "EPSG:3857"
          ),
        });
      }
    });
    areaFeature.setStyle(
      new Style({
        fill: new Fill({ color: "#4e98f444" }),
        stroke: new Stroke({
          width: 3,
          color: [71, 137, 227, 1],
        }),
      })
    );
    areaLayer.getSource().addFeatures([areaFeature]);
  },
};
</script>
```

:::

## 7.世界地图

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      format: { TopoJSON },
      Map,
      View,
      layer: { Tile: TileLayer, Vector: VectorLayer },
      source: { XYZ, Vector: VectorSource },
      style: { Fill, Stroke, Style },
    } = ol;
    const style = new Style({
      fill: new Fill({
        color: "rgba(255, 255, 255, 0.6)",
      }),
      stroke: new Stroke({
        color: "#319FD3",
        width: 1,
      }),
    });
    const vector = new VectorLayer({
      source: new VectorSource({
        url: this.$withBase("/data/topojson/world-110m.json"),
        format: new TopoJSON({
          layers: ["countries"],
        }),
        overlaps: false,
      }),
      style: style,
    });
    const map = new Map({
      layers: [vector],
      target: this.$refs.map,
      view: new View({
        center: [12579156, 3274244],
        zoom: 1,
      }),
    });
  },
};
</script>
```

:::

## 8.中国地图

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      format: { TopoJSON },
      Map,
      View,
      layer: { Tile: TileLayer, Vector: VectorLayer },
      source: { XYZ, Vector: VectorSource },
      style: { Fill, Stroke, Style },
    } = ol;
    let chinaLayer = new VectorLayer({
      source: new VectorSource({
        url: this.$withBase("/data/topojson/province.json"),
        format: new TopoJSON(),
      }),
      style: new Style({
        fill: new Fill({
          color: "#eeeeee",
        }),
        stroke: new Stroke({
          color: "#c3c3c4",
          width: 2,
          lineDash: [1, 2, 3, 4, 5, 6],
          lineDashOffset: 10,
        }),
      }),
    });
    const map = new Map({
      layers: [chinaLayer],
      target: this.$refs.map,
      view: new View({
        center: [12579156, 3274244],
        zoom: 1,
      }),
    });
    // function addHighlightLayer(layer) {
    //   layer = new ol.layer.Vector({
    //     source: new ol.source.Vector(),
    //     style: () => {
    //       const style = new ol.style.Style({
    //         fill: new ol.style.Fill({
    //           color: "raba(0,0,0,1)",
    //         }),
    //         stroke: new ol.style.Stroke({
    //           color: "rgba(255, 255, 255, 1)",
    //           width: 1,
    //         }),
    //       });
    //       return style;
    //     },
    //   });
    //   map.addLayer(layer);
    //   onBindLayerClick(layer);
    //   return layer;
    // }

    // function onBindLayerClick(layer) {
    //   layer.on("precompose", (evt) => {
    //     evt.context.shadowBlur = 25;
    //     evt.context.shadowColor = "black";
    //   });
    //   layer.on("postcompose", (evt) => {
    //     evt.context.shadowBlur = 0;
    //     evt.context.shadowColor = "black";
    //   });
    // }

    // var features = new ol.format.GeoJSON({
    //   featureProjection: "EPSG:3857",
    // }).readFeatures(this.$withBase("/data/topojson/province.json"));
    // var f = features[0];
    // chinaLayer.getSource().addFeature(f);
    // //添加阴影的图层
    // var highlightLayer = addHighlightLayer(chinaLayer);

    // //新增以下代码
    // highlightLayer.setStyle(() => {
    //   return new ol.style.Style({
    //     fill: new ol.style.Fill({
    //       color:
    //         f.style && f.style.getFill ? f.style.getFill().getColor() : "#aaa",
    //     }),
    //     stroke: new ol.style.Stroke({
    //       color: "rgba(255, 255, 255, 0.2)",
    //       width: 2,
    //     }),
    //   });
    // });
    // highlightLayer.getSource().addFeature(f);
  },
};
</script>
```

<style>
.map-container {
	position: relative;
	box-shadow: 0 0 10px rgba(0,0,0,0.5);
}
</style>

:::
