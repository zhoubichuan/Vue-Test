---
lang: zh-CN
sidebarDepth: 2
meta:
  - name: description
    content: 个人总结的openlayers学习技术文档-语法
  - name: keywords
    content: vuepress,最新技术文档,vuepress语法,markdown语法
---

# 十三.案例 13

## 1.页面滚动

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      Map,
      View,
      layer: { Tile: TileLayer },
      source: { OSM },
    } = ol
    const map = new Map({
      layers: [
        new TileLayer({
          source: new OSM(),
        }),
      ],
      target: this.$refs.map,
      view: new View({
        center: [12579156, 3274244],
        zoom: 2,
      }),
    })
  },
}
</script>
```

:::

## 2.平移和页面滚动

在触摸设备上，当一根手指放在地图上时，它可以用来滚动页面。只有两个手指将执行拖动平移。对于鼠标或触控板设备，平台修改键（Cmd 或 Ctrl）将启用地图上的拖动平移，否则页面将滚动

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      interaction: { DragPan, MouseWheelZoom, defaults },
      Map,
      View,
      layer: { Tile: TileLayer },
      source: { OSM },
      events: { condition: platformModifierKeyOnly },
    } = ol

    const map = new Map({
      interactions: defaults({ dragPan: false, mouseWheelZoom: false }).extend([
        new DragPan({
          condition: function (event) {
            return (
              this.getPointerCount() === 2 || platformModifierKeyOnly(event)
            )
          },
        }),
        new MouseWheelZoom({
          condition: platformModifierKeyOnly,
        }),
      ]),
      layers: [
        new TileLayer({
          source: new OSM(),
        }),
      ],
      target: this.$refs.map,
      view: new View({
        center: [12579156, 3274244],
        zoom: 2,
      }),
    })
  },
}
</script>
```

:::

## 3.永久链接

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      Map,
      View,
      layer: { Tile: TileLayer },
      source: { OSM },
    } = ol
    let zoom = 2
    let center = [0, 0]
    let rotation = 0

    if (window.location.hash !== "") {
      const hash = window.location.hash.replace("#map=", "")
      const parts = hash.split("/")
      if (parts.length === 4) {
        zoom = parseFloat(parts[0])
        center = [parseFloat(parts[1]), parseFloat(parts[2])]
        rotation = parseFloat(parts[3])
      }
    }
    const map = new Map({
      layers: [
        new TileLayer({
          source: new OSM(),
        }),
      ],
      target: this.$refs.map,
      view: new View({
        center: center,
        zoom: zoom,
        rotation: rotation,
      }),
    })
    let shouldUpdate = true
    const view = map.getView()
    const updatePermalink = function () {
      if (!shouldUpdate) {
        shouldUpdate = true
        return
      }
      const center = view.getCenter()
      const hash =
        "#map=" +
        view.getZoom().toFixed(2) +
        "/" +
        center[0].toFixed(2) +
        "/" +
        center[1].toFixed(2) +
        "/" +
        view.getRotation()
      const state = {
        zoom: view.getZoom(),
        center: view.getCenter(),
        rotation: view.getRotation(),
      }
      window.history.pushState(state, "map", hash)
    }
    map.on("moveend", updatePermalink)
    window.addEventListener("popstate", function (event) {
      if (event.state === null) {
        return
      }
      map.getView().setCenter(event.state.center)
      map.getView().setZoom(event.state.zoom)
      map.getView().setRotation(event.state.rotation)
      shouldUpdate = false
    })
  },
}
</script>
```

:::
