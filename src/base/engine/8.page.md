---
lang: zh-CN
sidebarDepth: 2
meta:
  - name: description
    content: 个人总结的openlayers学习技术文档-语法
  - name: keywords
    content: vuepress,最新技术文档,vuepress语法,markdown语法
---

# 八.Interactions

::: tip 前言
默认的交互功能，包含多个交互。规定了默认包含在地图中的功能，他们都是继承自 ol.interaction 类。 主要是最为常用的功能，如缩放、平移和旋转地图等。
:::

| 功能点            | 说明                                                     |
| ----------------- | -------------------------------------------------------- |
| doubleclickzoom   | 双击地图进行缩放                                         |
| draganddrop       | 以“拖文件到地图中”的交互添加图层                         |
| dragbox           | 拉框，用于划定一个矩形范围，常用于放大地图               |
| dragpan           | 拖拽平移地图                                             |
| dragrotateandzoom | 拖拽方式进行缩放和旋转地图                               |
| dragrotate        | 拖拽方式旋转地图                                         |
| draw              | 绘制地理要素功能                                         |
| keyboardpan       | 键盘方式平移地图                                         |
| keyboardzoom      | 键盘方式缩放地图                                         |
| select            | 选择要素功能                                             |
| modify            | 更改要素                                                 |
| mousewheelzoom    | 鼠标滚轮缩放功能                                         |
| pinchrotate       | 手指旋转地图，针对触摸屏                                 |
| pinchzoom         | 手指进行缩放，针对触摸屏                                 |
| pointer           | 鼠标的用户自定义事件基类                                 |
| snap              | 鼠标捕捉，当鼠标距离某个要素一定距离之内，自动吸附到要素 |

## 1.defaults

默认的交互功能，包含多个交互。规定了默认包含在地图中的功能，他们都是继承自 ol.interaction 类

| 功能点          | 说明                                   |
| --------------- | -------------------------------------- |
| DragRotate      | 鼠标拖拽旋转，一般配合一个键盘按键辅助 |
| DragZoom        | 鼠标拖拽缩放，一般配合一个键盘按键辅助 |
| DoubleClickZoom | 鼠标或手指双击缩放地图                 |
| PinchRotate     | 两个手指旋转地图，针对触摸屏           |
| PinchZoom       | 两个手指缩放地图，针对触摸屏           |
| DragPan         | 鼠标或手指拖拽平移地图                 |
| KeyboardZoom    | 使用键盘 + 和 - 按键进行缩放           |
| KeyboardPan     | 使用键盘方向键平移地图                 |
| MouseWheelZoom  | 鼠标滚轮缩放地图                       |

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      Map,
      View,
      layer: { Tile: TileLayer },
      source: { OSM },
    } = ol
    new Map({
      view: new View({
        center: [12579156, 3274244],
        zoom: 12,
      }),
      layers: [
        new TileLayer({
          source: new OSM(),
        }),
      ],
      target: this.$refs.map,
    })
  },
}
</script>
```

:::
## 1.DoubleClickZoom

双击地图进行缩放

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      interaction: { DoubleClickZoom, defaults },
      Map,
      View,
      layer: { Tile: TileLayer },
      source: { OSM },
    } = ol
    const map = new Map({
      view: new View({
        center: [12579156, 3274244],
        zoom: 12,
      }),
      layers: [
        new TileLayer({
          source: new OSM(),
        }),
      ],
      target: this.$refs.map,
    })
    // 删除默认的双击事件
    const dblClickInteraction = map
      .getInteractions()
      .getArray()
      .find(interaction => {
        return interaction instanceof DoubleClickZoom
    })
    map.removeInteraction(dblClickInteraction)
  },
}
</script>
```

:::

## 2.draganddrop

以“拖文件到地图中”的交互添加图层

## 3.dragbox

拉框，用于划定一个矩形范围，常用于放大地图

## 4.dragpan

拖拽平移地图

:::demo

```vue {18}
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      interaction: { DragPan, defaults },
      Map,
      View,
      layer: { Tile: TileLayer },
      source: { OSM },
      events: { condition: platformModifierKeyOnly },
    } = ol

    const map = new Map({
      interactions: defaults({ dragPan: false }),
      layers: [
        new TileLayer({
          source: new OSM(),
        }),
      ],
      target: this.$refs.map,
      view: new View({
        center: [12579156, 3274244],
        zoom: 12,
      }),
    })
  },
}
</script>
```

:::

## 5.dragrotateandzoom

拖拽方式进行缩放和旋转地图

## 6.dragrotate

拖拽方式旋转地图

## 7.dragzoom

拖拽方式缩放地图

## 8.draw

绘制地理要素功能

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
  <div class="row">
      <div class="col-auto">
        <span class="input-group">
          <label class="input-group-text" for="type">几何类型:</label>
          <select class="form-select" ref="type">
            <option value="Point">点</option>
            <option value="LineString">直线</option>
            <option value="Polygon">多边形</option>
            <option value="Circle">圆</option>
            <option value="None">无</option>
          </select>
          <input class="form-control" type="button" value="撤销" ref="undo">
        </span>
      </div>
    </div>
</template>

<script>
export default {
  mounted() {
    let {
      Map,
      View,
      layer: { Tile: TileLayer, Vector: VectorLayer },
      source: { OSM, Vector: VectorSource },
      interaction: { Draw },
    } = ol
    const raster = new TileLayer({
      source: new OSM(),
    })
    const source = new VectorSource({ wrapX: false })
    const vector = new VectorLayer({
      source: source,
    })
    const map = new Map({
      layers: [raster, vector],
      target: this.$refs.map,
      view: new View({
        center: [12579156, 3274244],
        zoom: 8,
      }),
    })
    const typeSelect = this.$refs.type
    let draw
    function addInteraction() {
      const value = typeSelect.value
      if (value !== "None") {
        draw = new Draw({
          source: source,
          type: typeSelect.value,
        })
        map.addInteraction(draw)
      }
    }
    typeSelect.onchange = function () {
      map.removeInteraction(draw)
      addInteraction()
    }
    this.$refs.undo.addEventListener("click", function () {
      draw.removeLastPoint()
    })
    addInteraction()
  },
}
</script>
```

:::

## 9.keyboardpan

键盘方式平移地图

## 10.keyboardzoom

键盘方式缩放地图

## 11.select

选择要素功能

## 12.modify

更改要素

## 13.mousewheelzoom

鼠标滚轮缩放功能
:::demo

```vue {18}
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      interaction: { MouseWheelZoom, defaults },
      Map,
      View,
      layer: { Tile: TileLayer },
      source: { OSM },
      events: { condition: platformModifierKeyOnly },
    } = ol

    const map = new Map({
      interactions: defaults({ mouseWheelZoom: false }),
      layers: [
        new TileLayer({
          source: new OSM(),
        }),
      ],
      target: this.$refs.map,
      view: new View({
        center: [12579156, 3274244],
        zoom: 2,
      }),
    })
  },
}
</script>
```

:::

## 14.pinchrotate

手指旋转地图，针对触摸屏

## 15.pinchzoom

手指进行缩放，针对触摸屏

## 16.pointer

鼠标的用户自定义事件基类

## 17.snap

鼠标捕捉，当鼠标距离某个要素一定距离之内，自动吸附到要素
