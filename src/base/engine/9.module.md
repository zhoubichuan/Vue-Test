---
lang: zh-CN
sidebarDepth: 2
meta:
  - name: description
    content: 个人总结的openlayers学习技术文档-语法
  - name: keywords
    content: vuepress,最新技术文档,vuepress语法,markdown语法
---

# 九.Map 方法

## 1.中心坐标

view.getCenter()

:::demo

```vue
<template>
  <div ref="map" class="map">
    <div ref="popup"></div>
  </div>
  <div ref="info"></div>
</template>

<script>
export default {
  mounted() {
    let {
      geom: { Point },
      Feature,
      Map,
      Overlay,
      View,
      layer: { Tile: TileLayer, Vector: VectorLayer },
      source: { OSM, Vector: VectorSource },
      style: { Circle, Fill, Style },
      proj: { useGeographic },
    } = ol
    useGeographic()
    const place = [-110, 45]
    const point = new Point(place)
    const map = new Map({
      target: this.$refs.map,
      view: new View({
        center: place,
        zoom: 8,
      }),
      layers: [
        new TileLayer({
          source: new OSM(),
        }),
        new VectorLayer({
          source: new VectorSource({
            features: [new Feature(point)],
          }),
          style: new Style({
            image: new Circle({
              radius: 9,
              fill: new Fill({ color: "red" }),
            }),
          }),
        }),
      ],
    })
    const element = this.$refs.popup
    const popup = new Overlay({
      element: element,
      positioning: "bottom-center",
      stopEvent: false,
      offset: [0, -10],
    })
    map.addOverlay(popup)
    function formatCoordinate(coordinate) {
      return `
    <table>
      <tbody>
        <tr><th>lon</th><td>${coordinate[0].toFixed(2)}</td></tr>
        <tr><th>lat</th><td>${coordinate[1].toFixed(2)}</td></tr>
      </tbody>
    </table>`
    }
    const info = this.$refs.info
    map.on("moveend", function () {
      const view = map.getView()
      const center = view.getCenter()
      info.innerHTML = formatCoordinate(center)
    })
    map.on("click", function (event) {
      const feature = map.getFeaturesAtPixel(event.pixel)[0]
      if (feature) {
        const coordinate = feature.getGeometry().getCoordinates()
        popup.setPosition([
          coordinate[0] + Math.round(event.coordinate[0] / 360) * 360,
          coordinate[1],
        ])
        info.innerHTML = formatCoordinate(coordinate)
      }
    })
    map.on("pointermove", function (event) {
      if (map.hasFeatureAtPixel(event.pixel)) {
        map.getViewport().style.cursor = "pointer"
      } else {
        map.getViewport().style.cursor = "inherit"
      }
    })
  },
}
</script>
```

:::

## 2.Moveend 事件

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
  <label>left: <input readonly="readonly" type="text" id="left" /></label>
  <label>right: <input readonly="readonly" type="text" id="right" /></label>
  <label>bottom: <input readonly="readonly" type="text" id="bottom" /></label>
  <label>top: <input readonly="readonly" type="text" id="top" /></label>
</template>

<script>
export default {
  mounted() {
    let {
      Map,
      View,
      layer: { Tile: TileLayer },
      source: { OSM },
      extent: { getBottomLeft, getTopRight },
      proj: { toLonLat },
    } = ol
    const map = new Map({
      layers: [
        new TileLayer({
          source: new OSM(),
        }),
      ],
      target: this.$refs.map,
      view: new View({
        center: [12579156, 3274244],
        zoom: 2,
      }),
    })
    function display(id, value) {
      document.getElementById(id).value = value.toFixed(2)
    }
    function wrapLon(value) {
      const worlds = Math.floor((value + 180) / 360)
      return value - worlds * 360
    }
    function onMoveEnd(evt) {
      const map = evt.map
      const extent = map.getView().calculateExtent(map.getSize())
      const bottomLeft = toLonLat(getBottomLeft(extent))
      const topRight = toLonLat(getTopRight(extent))
      display("left", wrapLon(bottomLeft[0]))
      display("bottom", bottomLeft[1])
      display("right", wrapLon(topRight[0]))
      display("top", topRight[1])
    }
    map.on("moveend", onMoveEnd)
  },
}
</script>
```

:::
