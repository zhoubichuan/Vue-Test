---
lang: zh-CN
sidebarDepth: 2
meta:
  - name: description
    content: 个人总结的openlayers学习技术文档-语法
  - name: keywords
    content: vuepress,最新技术文档,vuepress语法,markdown语法
---

# 一.案例1

## 1.高 DPI WMTS

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      format: { WMTSCapabilities },
      Map,
      View,
      layer: { Tile: TileLayer },
      source: {
        WMTS: { optionsFromCapabilities },
      },
      has: { DEVICE_PIXEL_RATIO },
    } = ol
    const capabilitiesUrl = "https://basemap.at/wmts/1.0.0/WMTSCapabilities.xml"
    const hiDPI = DEVICE_PIXEL_RATIO > 1
    const layer = hiDPI ? "bmaphidpi" : "geolandbasemap"
    const tilePixelRatio = hiDPI ? 2 : 1

    const map = new Map({
      target: this.$refs.map,
      view: new View({
        center: [1823849, 6143760],
        zoom: 11,
      }),
    })

    fetch(capabilitiesUrl)
      .then(function (response) {
        return response.text()
      })
      .then(function (text) {
        const result = new WMTSCapabilities().read(text)
        const options = optionsFromCapabilities(result, {
          layer: layer,
          matrixSet: "google3857",
          style: "normal",
        })
        options.tilePixelRatio = tilePixelRatio
        options.attributions =
          'Grundkarte: <a target="_blank" href="https://basemap.at/">basemap.at</a>'
        map.addLayer(
          new TileLayer({
            source: new WMTS(options),
          })
        )
      })
  },
}
</script>
```

:::

## 2.命中容忍度

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
  <span id="status">Try to click the line in the map.</span>
  <form class="form-inline">
    <label for="hitTolerance"
      >Hit tolerance for selecting features: &nbsp;</label
    >
    <select id="hitTolerance" class="form-control">
      <option value="0" selected>0 Pixels</option>
      <option value="5">5 Pixels</option>
      <option value="10">10 Pixels</option>
    </select>
    &nbsp; Area: &nbsp;
    <canvas id="circle" style="vertical-align: middle" />
  </form>
</template>

<script>
export default {
  mounted() {
    let {
      Feature,
      geom: { LineString },
      Map,
      View,
      layer: { Tile: TileLayer, Vector: VectorLayer },
      source: { OSM, Vector: VectorSource },
      style: { Stroke, Style },
    } = ol
    const raster = new TileLayer({
      source: new OSM(),
    })

    const style = new Style({
      stroke: new Stroke({
        color: "black",
        width: 1,
      }),
    })

    const feature = new Feature(
      new LineString([[13451034.958002912,3594986.8806004445],[13451034.958002912,3594986.8806004445],[13451034.958002912,3594986.8806004445],[13451034.946870962,3594986.8806004445],[13451034.958002912,3594986.8806004445],[13451034.958002912,3594986.8806004445],[13451034.958002912,3594986.8806004445],[13451034.958002912,3594986.8806004445],[13451034.935739014,3594986.8676529187],[13451034.891211215,3594986.854705386],[13451034.902343167,3594986.841757856],[13451034.98026681,3594986.854705386],[13451035.058190454,3594986.8806004445],[13451035.069322404,3594986.9064955027],[13451035.080454351,3594986.9194430322],[13451035.058190454,3594986.9453380946],[13451035.013662657,3594986.9712331533],[13451034.946870962,3594986.815862797],[13451034.646308336,3594985.974273401],[13451034.312349865,3594984.964366199],[13451033.644432921,3594982.8539193613],[13451033.076703517,3594981.1318985843],[13451032.163883692,3594978.399971379],[13451031.585022341,3594976.574371066],[13451030.883709548,3594974.2567653796],[13451030.405035736,3594972.9749613027],[13451029.614667352,3594971.382417024],[13451028.91335456,3594970.463143591],[13451027.399409488,3594969.064812301],[13451026.063575596,3594968.01606394],[13451023.558887055,3594966.0998325846],[13451021.499476476,3594964.5461317045],[13451017.870461075,3594961.865998138],[13451015.076341856,3594959.7426077025],[13451010.601298327,3594956.1949927807],[13451007.40642894,3594953.6831784467],[13451002.719878377,3594950.070827786],[13450999.680856278,3594947.714384551],[13450995.461847577,3594944.4904601853],[13450993.00168683,3594942.522442507],[13450989.951532785,3594940.0235784035],[13450988.259476524,3594938.689987919],[13450986.322517384,3594937.136290448],[13450985.298378067,3594936.3723892625],[13450983.895752486,3594935.634383076],[13450982.938404866,3594935.3754335465],[13450981.569175126,3594935.2589062625],[13450980.56729971,3594935.3754335465],[13450978.76392396,3594935.763857843],[13450977.327902526,3594936.165229628],[13450974.700762544,3594936.877340891],[13450972.518900527,3594937.4729248835],[13450968.444607163,3594938.5216706838],[13450965.260869725,3594939.3891518447],[13450960.162437048,3594940.774532327],[13450956.377574362,3594941.6808560966],[13450950.70028033,3594943.14392174],[13450947.126924677,3594944.1149831056],[13450942.373582419,3594945.396784221],[13450939.501539556,3594946.1218434973],[13450935.872524155,3594947.0281676473],[13450933.913301118,3594947.5460671955],[13450931.675779354,3594948.063966761],[13450930.61824419,3594948.3358640433],[13450929.605236825,3594948.620708821],[13450929.17109081,3594948.6466038],[13450928.881660135,3594948.555971372],[13450928.915055983,3594948.3617590223],[13450929.07090327,3594947.882701911],[13450929.182222757,3594947.4036448137],[13450929.41599369,3594946.4325831956],[13450929.672028521,3594945.513311602],[13450930.172966225,3594943.4935038215],[13450930.595980292,3594941.6161186807],[13450931.375216728,3594938.2109311786],[13450932.009737825,3594935.4660658822],[13450933.122932734,3594930.623710653],[13450933.935565015,3594926.933681855],[13450935.249135006,3594921.0296380525],[13450936.217614576,3594916.76992397],[13450937.698163806,3594910.3738818485],[13450938.633247528,3594906.308383091],[13450939.92455362,3594900.740982479],[13450940.714922007,3594897.3228586856],[13450941.75019327,3594892.894836071],[13450942.306790726,3594890.408929322],[13450942.829992332,3594887.482810558],[13450943.119423006,3594885.9550143057],[13450943.497909276,3594884.168269774],[13450943.642624615,3594883.3266872955],[13450943.842999697,3594882.7958429884],[13450944.054506728,3594882.8735275217],[13450944.52204859,3594883.3266872955],[13450944.922798758,3594883.805741931],[13450945.713167142,3594884.828588375],[13450946.414479934,3594885.6701709577],[13450947.616730435,3594887.1073351917],[13450948.574078057,3594888.285551038],[13450950.199342621,3594890.266507596],[13450951.434988968,3594891.8072518054],[13450953.438739803,3594894.461475471],[13450954.94155293,3594896.403590706],[13450957.513033168,3594899.3944487544],[13450959.427728407,3594901.414249396],[13450962.433354659,3594904.5086882035],[13450964.581820833,3594906.6968064797],[13450968.043856997,3594910.127880293],[13450970.581941385,3594912.6137909633],[13450974.589443054,3594916.575712117],[13450977.461485915,3594919.4371003974],[13450981.981057243,3594923.9169222806],[13450985.086871035,3594927.01136666],[13450989.907004986,3594931.8148780735],[13450993.13527022,3594935.077641595],[13450997.788424935,3594939.583364052],[13451000.838578982,3594942.4577050894],[13451005.068719633,3594946.600900538],[13451007.695859618,3594949.216293377],[13451011.391666712,3594952.8415912804],[13451013.718244068,3594955.107403007],[13451016.84632176,3594958.111222615],[13451018.816676747,3594959.9886102355],[13451021.499476476,3594962.707585913],[13451023.13587299,3594964.338971603],[13451025.29547111,3594966.3846777687],[13451026.531117458,3594967.6664811685],[13451028.156382026,3594969.466185157],[13451029.080333797,3594970.6055662315],[13451030.115605064,3594972.4441131866],[13451030.705598362,3594973.8165498227],[13451031.518230647,3594976.017627763],[13451032.030300304,3594977.558382548],[13451032.731613096,3594979.888936371],[13451033.188023008,3594981.416744113],[13451033.755752413,3594983.397715446],[13451034.100842834,3594984.4464650997],[13451034.49046105,3594985.6117426003],[13451034.668572236,3594986.155538802],[13451034.857815368,3594986.660492443],[13451034.935739014,3594986.841757856],[13451034.946870962,3594986.9064955027],[13451034.946870962,3594986.854705386],[13451034.958002912,3594986.8288103268],[13451034.96913486,3594986.802915268],[13451034.935739014,3594986.7770202095],[13451034.902343167,3594986.764072676],[13451034.857815368,3594986.764072676],[13451034.83555147,3594986.802915268],[13451034.791023675,3594986.8288103268],[13451034.824419523,3594986.815862797],[13451034.891211215,3594986.815862797],[13451034.86894732,3594986.841757856],[13451034.84668342,3594986.854705386],[13451034.86894732,3594986.854705386],[13451034.902343167,3594986.841757856],[13451034.913475113,3594986.854705386],[13451034.924607065,3594986.8676529187],[13451034.935739014,3594986.854705386],[13451034.946870962,3594986.854705386],[13451034.958002912,3594986.8676529187],[13451034.958002912,3594986.841757856],[13451034.946870962,3594986.8288103268],[13451034.935739014,3594986.854705386],[13451034.935739014,3594986.8676529187],[13451034.924607065,3594986.9064955027],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.9194430322],[13451034.924607065,3594986.9194430322],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.9194430322],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.958285624],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.958285624],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9194430322],[13451034.935739014,3594986.9194430322],[13451034.935739014,3594986.9194430322],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.9453380946],[13451034.924607065,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.946870962,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.924607065,3594986.9194430322],[13451034.946870962,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9194430322],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.924607065,3594986.9194430322],[13451034.924607065,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.946870962,3594986.9453380946],[13451034.946870962,3594986.9453380946],[13451034.946870962,3594986.9453380946],[13451034.935739014,3594986.958285624],[13451034.935739014,3594986.9712331533],[13451034.924607065,3594986.958285624],[13451034.924607065,3594986.958285624],[13451034.935739014,3594986.9453380946],[13451034.946870962,3594986.9194430322],[13451034.946870962,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.946870962,3594986.9453380946],[13451034.946870962,3594986.9453380946],[13451034.958002912,3594986.958285624],[13451034.958002912,3594986.9712331533],[13451034.946870962,3594986.9712331533],[13451034.946870962,3594986.958285624],[13451034.946870962,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.913475113,3594986.9194430322],[13451034.913475113,3594986.9064955027],[13451034.935739014,3594986.932390565],[13451034.946870962,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.946870962,3594986.932390565],[13451034.946870962,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.924607065,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.932390565],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946],[13451034.935739014,3594986.9453380946]])
    )

    const vector = new VectorLayer({
      source: new VectorSource({
        features: [feature],
      }),
      style: style,
    })

    const map = new Map({
      layers: [raster, vector],
      target: this.$refs.map,
      view: new View({
        center:[12579156, 3274244],
        zoom: 2,
      }),
    })

    let hitTolerance

    const statusElement = document.getElementById("status")

    map.on("singleclick", function (e) {
      let hit = false
      map.forEachFeatureAtPixel(
        e.pixel,
        function () {
          hit = true
        },
        {
          hitTolerance: hitTolerance,
        }
      )
      if (hit) {
        style.getStroke().setColor("green")
        statusElement.innerHTML = "A feature got hit!"
      } else {
        style.getStroke().setColor("black")
        statusElement.innerHTML = "No feature got hit."
      }
      feature.changed()
    })

    const selectHitToleranceElement = document.getElementById("hitTolerance")
    const circleCanvas = document.getElementById("circle")

    const changeHitTolerance = function () {
      hitTolerance = parseInt(selectHitToleranceElement.value, 10)

      const size = 2 * hitTolerance + 2
      circleCanvas.width = size
      circleCanvas.height = size
      const ctx = circleCanvas.getContext("2d")
      ctx.clearRect(0, 0, size, size)
      ctx.beginPath()
      ctx.arc(
        hitTolerance + 1,
        hitTolerance + 1,
        hitTolerance + 0.5,
        0,
        2 * Math.PI
      )
      ctx.fill()
      ctx.stroke()
    }

    selectHitToleranceElement.onchange = changeHitTolerance
    changeHitTolerance()
  },
}
</script>
```

:::

## 3.图标颜色

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      Feature,
      geom: { Point },
      Map,
      View,
      layer: { Tile: TileLayer, Vector: VectorLayer },
      source: { TileJSON, Vector: VectorSource },
      style: { Icon, Style },
      proj: { fromLonLat },
    } = ol
    const rome = new Feature({
      geometry: new Point(fromLonLat([12.5, 41.9])),
    })

    const london = new Feature({
      geometry: new Point(fromLonLat([-0.12755, 51.507222])),
    })

    const madrid = new Feature({
      geometry: new Point(fromLonLat([-3.683333, 40.4])),
    })
    const paris = new Feature({
      geometry: new Point(fromLonLat([2.353, 48.8566])),
    })
    const berlin = new Feature({
      geometry: new Point(fromLonLat([13.3884, 52.5169])),
    })

    rome.setStyle(
      new Style({
        image: new Icon({
          color: "#BADA55",
          crossOrigin: "anonymous",
          // For Internet Explorer 11
          imgSize: [20, 20],
          src: "data/square.svg",
        }),
      })
    )

    london.setStyle(
      new Style({
        image: new Icon({
          color: "rgba(255, 0, 0, .5)",
          crossOrigin: "anonymous",
          src: "data/bigdot.png",
          scale: 0.2,
        }),
      })
    )

    madrid.setStyle(
      new Style({
        image: new Icon({
          crossOrigin: "anonymous",
          src: "data/bigdot.png",
          scale: 0.2,
        }),
      })
    )

    paris.setStyle(
      new Style({
        image: new Icon({
          color: "#8959A8",
          crossOrigin: "anonymous",
          // For Internet Explorer 11
          imgSize: [20, 20],
          src: "data/dot.svg",
        }),
      })
    )

    berlin.setStyle(
      new Style({
        image: new Icon({
          crossOrigin: "anonymous",
          // For Internet Explorer 11
          imgSize: [20, 20],
          src: "data/dot.svg",
        }),
      })
    )
    const vectorSource = new VectorSource({
      features: [rome, london, madrid, paris, berlin],
    })

    const vectorLayer = new VectorLayer({
      source: vectorSource,
    })

    const rasterLayer = new TileLayer({
      source: new TileJSON({
        url: "https://a.tiles.mapbox.com/v4/aj.1x1-degrees.json?secure=1",
        crossOrigin: "",
      }),
    })

    const map = new Map({
      layers: [rasterLayer, vectorLayer],
      target: this.$refs.map,
      view: new View({
        center: fromLonLat([2.896372, 44.6024]),
        zoom: 3,
      }),
    })
  },
}
</script>
```

:::

## 4.图标修改

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
</template>

<script>
export default {
  mounted() {
    let {
      Feature,
      geom: { Point },
      Map,
      View,
      layer: { Tile: TileLayer, Vector: VectorLayer },
      source: { TileJSON, Vector: VectorSource },
      style: { Icon, Style },
      interaction: { Modify },
    } = ol

    const iconFeature = new Feature({
      geometry: new Point([0, 0]),
      name: "Null Island",
      population: 4000,
      rainfall: 500,
    })

    const iconStyle = new Style({
      image: new Icon({
        anchor: [0.5, 46],
        anchorXUnits: "fraction",
        anchorYUnits: "pixels",
        src: this.$withBase("/data/icon.png"),
      }),
    })

    iconFeature.setStyle(iconStyle)

    const vectorSource = new VectorSource({
      features: [iconFeature],
    })

    const vectorLayer = new VectorLayer({
      source: vectorSource,
    })

    const rasterLayer = new TileLayer({
      source: new TileJSON({
        url: "https://a.tiles.mapbox.com/v4/aj.1x1-degrees.json?secure=1",
        crossOrigin: "",
      }),
    })

    const target = this.$refs.map
    const map = new Map({
      layers: [rasterLayer, vectorLayer],
      target: target,
      view: new View({
        center:[12579156, 3274244],
        zoom: 3,
      }),
    })

    const modify = new Modify({
      hitDetection: vectorLayer,
      source: vectorSource,
    })
    modify.on(["modifystart", "modifyend"], function (evt) {
      target.style.cursor = evt.type === "modifystart" ? "grabbing" : "pointer"
    })
    const overlaySource = modify.getOverlay().getSource()
    overlaySource.on(["addfeature", "removefeature"], function (evt) {
      target.style.cursor = evt.type === "addfeature" ? "pointer" : ""
    })

    map.addInteraction(modify)
  },
}
</script>
```

:::

## 5.图标像素操作

:::demo

```vue
<template>
  <div id="map" class="map">
    <div id="popup"></div>
  </div>
</template>

<script>
export default {
  mounted() {
    let {
      Feature,
      Overlay,
      geom: { Point },
      Map,
      View,
      layer: { Tile: TileLayer, Vector: VectorLayer },
      source: { TileJSON, Vector: VectorSource },
      style: { Icon, Style, Text },
      proj: { fromLonLat },
      render: { getVectorContext },
    } = ol

    const rasterLayer = new TileLayer({
      source: new TileJSON({
        url: "https://a.tiles.mapbox.com/v4/aj.1x1-degrees.json?secure=1",
        crossOrigin: "",
      }),
    })

    const iconFeature = new Feature({
      geometry: new Point(fromLonLat([0, -10])),
      name: "Fish.1",
    })

    const feature1 = new Feature({
      geometry: new Point(fromLonLat([0, -10])),
      name: "Fish.1 Island",
    })

    const feature2 = new Feature({
      geometry: new Point(fromLonLat([-30, 10])),
      name: "Fish.2 Island",
    })

    const iconStyle = new Style({
      image: new Icon({
        anchor: [0.5, 0.9],
        src: "data/fish.png",
        crossOrigin: "",
        scale: [0, 0],
        rotation: Math.PI / 4,
      }),
      text: new Text({
        text: "FISH\nTEXT",
        scale: [0, 0],
        rotation: Math.PI / 4,
        textAlign: "center",
        textBaseline: "top",
      }),
    })

    let i = 0
    let j = 45

    iconFeature.setStyle(function () {
      const x = Math.sin((i * Math.PI) / 180) * 3
      const y = Math.sin((j * Math.PI) / 180) * 4
      iconStyle.getImage().setScale([x, y])
      iconStyle.getText().setScale([x, y])
      return iconStyle
    })

    rasterLayer.on("postrender", function (event) {
      const vectorContext = getVectorContext(event)
      const x = Math.cos((i * Math.PI) / 180) * 3
      const y = Math.cos((j * Math.PI) / 180) * 4
      iconStyle.getImage().setScale([x, y])
      iconStyle.getText().setScale([x, y])
      vectorContext.drawFeature(feature2, iconStyle)
    })

    const vectorSource = new VectorSource({
      features: [iconFeature, feature1, feature2],
    })

    const vectorLayer = new VectorLayer({
      source: vectorSource,
    })

    const map = new Map({
      layers: [rasterLayer, vectorLayer],
      target: this.$refs.map,
      view: new View({
        center: fromLonLat([-15, 0]),
        zoom: 3,
      }),
    })

    setInterval(function () {
      i = (i + 4) % 360
      j = (j + 5) % 360
      vectorSource.changed()
    }, 1000)

    const element = document.getElementById("popup")

    const popup = new Overlay({
      element: element,
      positioning: "bottom-center",
      stopEvent: false,
    })
    map.addOverlay(popup)

    // display popup on click
    map.on("click", function (evt) {
      const feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {
        return feature
      })
      $(element).popover("dispose")
      if (feature) {
        popup.setPosition(evt.coordinate)
        $(element).popover({
          placement: "top",
          html: true,
          animation: false,
          content: feature.get("name"),
        })
        $(element).popover("show")
      }
    })

    // change mouse cursor when over marker
    map.on("pointermove", function (e) {
      const pixel = map.getEventPixel(e.originalEvent)
      const hit = map.hasFeatureAtPixel(pixel)
      map.getTarget().style.cursor = hit ? "pointer" : ""
    })
    // Close the popup when the map is moved
    map.on("movestart", function () {
      $(element).popover("dispose")
    })
  },
}
</script>
```

:::
