---
lang: zh-CN
sidebarDepth: 2
meta:
  - name: description
    content: 个人总结的openlayers学习技术文档-语法
  - name: keywords
    content: Event
---

# 十.Event 属性

## 2.altKeyOnly、click、pointerMove

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
  <form class="form-inline">
    <label for="type">动作类型 &nbsp;</label>
    <select ref="type" class="form-control">
      <option value="click" selected>点击</option>
      <option value="singleclick">单击</option>
      <option value="pointermove">悬停</option>
      <option value="altclick">Alt+Click</option>
      <option value="none">无</option>
    </select>
    <span id="status">&nbsp;0 selected features</span>
  </form>
</template>

<script>
export default {
  mounted() {
    let {
      format: { GeoJSON },
      Map,
      View,
      layer: { Vector: VectorLayer },
      source: { Vector: VectorSource },
      style: { Fill, Stroke, Style },
      interaction: { Select },
      events: {
        condition: { altKeyOnly, click, pointerMove },
      },
    } = ol
    const style = new Style({
      fill: new Fill({
        color: "#eeeeee",
      }),
    })
    const vector = new VectorLayer({
      source: new VectorSource({
        url: "https://openlayers.org/data/vector/ecoregions.json",
        format: new GeoJSON(),
      }),
      background: "white",
      style: function (feature) {
        const color = feature.get("COLOR") || "#eeeeee"
        style.getFill().setColor(color)
        return style
      },
    })
    const map = new Map({
      layers: [vector],
      target: this.$refs.map,
      view: new View({
        center: [12579156, 3274244],
        zoom: 2,
      }),
    })
    let select = null
    const selected = new Style({
      fill: new Fill({
        color: "#eeeeee",
      }),
      stroke: new Stroke({
        color: "rgba(255, 255, 255, 0.7)",
        width: 2,
      }),
    })
    function selectStyle(feature) {
      const color = feature.get("COLOR") || "#eeeeee"
      selected.getFill().setColor(color)
      return selected
    }
    const selectSingleClick = new Select({ style: selectStyle })
    const selectClick = new Select({
      condition: click,
      style: selectStyle,
    })
    const selectPointerMove = new Select({
      condition: pointerMove,
      style: selectStyle,
    })
    const selectAltClick = new Select({
      style: selectStyle,
      condition: function (mapBrowserEvent) {
        return click(mapBrowserEvent) && altKeyOnly(mapBrowserEvent)
      },
    })
    const selectElement = this.$refs.type
    const changeInteraction = function () {
      if (select !== null) {
        map.removeInteraction(select)
      }
      const value = selectElement.value
      if (value == "singleclick") {
        select = selectSingleClick
      } else if (value == "click") {
        select = selectClick
      } else if (value == "pointermove") {
        select = selectPointerMove
      } else if (value == "altclick") {
        select = selectAltClick
      } else {
        select = null
      }
      if (select !== null) {
        map.addInteraction(select)
        select.on("select", function (e) {
          document.getElementById("status").innerHTML =
            "&nbsp;" +
            e.target.getFeatures().getLength() +
            " selected features (last operation selected " +
            e.selected.length +
            " and deselected " +
            e.deselected.length +
            " features)"
        })
      }
    }
    selectElement.onchange = changeInteraction
    changeInteraction()
  },
}
</script>
```

:::

## 3.pointermove

:::demo

```vue
<template>
  <div ref="map" class="map"></div>
  <span ref="status">&nbsp;</span>
</template>

<script>
export default {
  mounted() {
    let {
      format: { GeoJSON },
      Map,
      View,
      layer: { Vector: VectorLayer },
      source: { Vector: VectorSource },
      style: { Fill, Stroke, Style },
    } = ol
    const style = new Style({
      fill: new Fill({
        color: "#eeeeee",
      }),
    })
    const vector = new VectorLayer({
      source: new VectorSource({
        url: "https://openlayers.org/data/vector/ecoregions.json",
        format: new GeoJSON(),
      }),
      background: "white",
      style: function (feature) {
        const color = feature.get("COLOR") || "#eeeeee"
        style.getFill().setColor(color)
        return style
      },
    })
    const map = new Map({
      layers: [vector],
      target: this.$refs.map,
      view: new View({
        center: [12579156, 3274244],
        zoom: 2,
      }),
    })
    const selectStyle = new Style({
      fill: new Fill({
        color: "#eeeeee",
      }),
      stroke: new Stroke({
        color: "rgba(255, 255, 255, 0.7)",
        width: 2,
      }),
    })
    const status = this.$refs.status
    let selected = null
    map.on("pointermove", function (e) {
      if (selected !== null) {
        selected.setStyle(undefined)
        selected = null
      }
      map.forEachFeatureAtPixel(e.pixel, function (f) {
        selected = f
        selectStyle.getFill().setColor(f.get("COLOR") || "#eeeeee")
        f.setStyle(selectStyle)
        return true
      })
      if (selected) {
        status.innerHTML = selected.get("ECO_NAME")
      } else {
        status.innerHTML = "&nbsp;"
      }
    })
  },
}
</script>
```

:::

## 1.鼠标触发事件
- click：鼠标单击地图触发的事件（鼠标单击多少次地图，该事件就触发多少次）
- singleclick：鼠标单击地图触发的事件（鼠标若在250ms内连续单击地图，则不会触发该事件）
- dbclick：鼠标双击地图触发的事件（鼠标在250ms内单击两次地图）
- pointermove：鼠标指针在地图上移动触发的事件
- pointerdrag：鼠标按下拖动地图触发的事件

## 2.地图移动事件
- movestart：地图开始移动时触发的事件（包括平移和缩放）
- moveend：地图结束移动时触发的事件（包括平移和缩放）

## 3.图层渲染事件
- precompose：一个图层渲染前触发的事件
- postcompose：一个图层渲染时触发的事件
- postrender：一个图层渲染完成后触发的事件
- （上述三个渲染事件的解释是我测试后得出的，与官方API的解释有所出入，如若有误还望指正。）
- rendercomplete：所有的渲染都完成后触发的事件（所有的图层、瓦片都完成了在当前视图的加载）

## 4.change事件
- change：地图出现改变时触发的事件（改变可以是任何地图事件）
- change:layerGroup：地图的图层发生改变时触发的事件（例如图层的增加、删除）
- change:size：可供地图显示的窗口大小发生改变时触发的事件（例如将浏览器窗口缩小化）
- change:target：地图所在div块发生改变时触发的事件（例如切换地图的显示位置）
- change:view：地图视图发生改变时触发的事件（例如视图中心的变化）

## 5.其它事件
- propertychange：地图属性更改时触发的事件
- error：地图运行发生错误时触发事件